# 模块十八 成对数据的统计分析

## 18.1 成对数据的统计相关性

### 样本相关系数 $r$

$$r=\frac{1}{n}(\acute{x_1}\acute{y_1}+\acute{x_2}\acute{y_2}+...+\acute{x_n}\acute{y_n})$$

$$=\frac{\sum_{i=1}^{n} (x_i-\bar{x} )(y_i-\bar{y})}{\sqrt{\sum_{i=1}^{n}(x_i-\bar{x})^2}\sqrt{\sum_{i=1}^{n}(y_i-\bar{y})^2} }$$

当 $r>0$ 时，称成对样本数据正相关；当 $r<0$ 时，称成对样本数据负相关。

样本相关系数 $r$ 的取值范围为 $[-1,1]$，当 $\abs{r}$ 越接近 1 ，成对样本数据的线性相关程度越强；当 $\abs{r}$ 越接近 0 ，成对样本数据的线性相关强度越弱。

## 18.2 一元线性回归模型及其应用

### 一元线性回归模型

对于下列式子：

$$Y=bx+a+e ①$$

$$E(e)=0 , D(e)=\omega^2 ②$$

其中①式为 $Y$ 关于 $x$ 的一元线性回归模型，其中 $Y$ 称作因变量或响应变量，$x$ 称作自变量或解释变量；$a$ 称为截距参数， $b$ 称为斜率参数。若 $e=0$ ，则 $Y$ 与 $x$ 的关系就可用一元线性函数关系来描述。

### 整体接近程度与最小二乘法

由上式中 $Y=bx+a+e$ 可知，通过成对的样本数据估计参数 $a,b$ 相当于寻找直线使数据散点在整体上接近该直线。在统计中，我们通常用各散点到直线的竖直距离的平方和，即

$$Q=\sum_{i=1}^{n}(y_i-bx_i-a)^2$$

来刻画整体接近程度。由于 $x_i,y_i$ 是已知的样本数据，故 $Q$ 是 $a$ 和 $b$ 的函数。由函数形可知，$Q$ 的实质是随机误差的平方和，这个误差越小越好。故我们求取令 $Q$ 达到最小的 $a,b$ 作为直线斜率和截距的估计值。

经推导，当 $a,b$ 的取值符合：

$$\hat{b}=\frac{\sum_{i=1}^{n}(x_i-\bar{x} )(y_i-\bar{y} )}{\sum_{i=1}^{n}(x_i-\bar{x})^2} ,$$

$$\hat{a}=\bar{y}-\hat{b}\bar{x}$$

时，$Q$ 达到最小。我们将 $\hat{y}=\hat{b}x+\hat{a}$ 称作 $Y$ 关于 $x$ 的经验回归方程，这种求法即为最小二乘(即平方)法。

对于响应变量 $Y$，通过观测得到的数据称作观测值，通过经验回归方程得到的 $\hat{y}$ 称作预测值，观测值与预测值之差叫做残差。

## 18.3 列联表与独立性检验

### 列联表与零假设

|性别|经常锻炼($Y=0$)|不经常锻炼($Y=1$)|合计|
|:------:|:------:|:------:|:------:|
|女生($X=0$)|192|331|523|
|男生($X=1$)|128|473|601|
|合计|320|804|1124|

我们将如上这种形式的数据统计表称作 2x2 列联表。在统计中，比较简单的做法是利用随机抽样获得一定量的样本数据，再利用随机事件发生的**频率稳定于概率**的原理对答案作出推断。

对于以 $\Omega$ 为样本空间的古典概型，设 $X,Y$ 为定义在 $\Omega$ 上且取值于 $[0,1]$ 的成对分类变量。我们希望判断事件 ${X=1}$ 与 ${Y=1}$ 之间是否有关联。由于 ${X=0},{X=1}$ 互为对立事件，${Y=0},{Y=1}$ 互为对立事件，我们应当判断下面的假设关系

$$H_0=P(Y=1|X=0)=P(Y=1|X=1)$$

是否成立。我们将 $H_0$ 称作零假设或原假设。由概率知识可知，零假设 $H_0$ 即表示分类变量 $X$ 与 $Y$ 独立。

### 卡方($\chi^2$)独立性检验

对于下列式子

$$\chi^2=\frac{n(ad-bc)^2}{(a+b)(c+d)(a+c)(b+d)}$$

对于任何小概率值 $a$，均可以找到相应的正实数 $x_a$ 令 $P(\chi^2 \ge x_a)=a$ 成立，此时的 $x_a$ 称作 $a$ 的临界值。

基于小概率值 $a$ 的检验规则为：

**当$\chi^2 \ge x_a$时，我们推断 $H_0$ 不成立，即认为 $X$ 与 $Y$ 不独立，该推断犯错误的概率不超过 $a$ ；**

**当$\chi^2 < x_a$时，我们没有充分理由推断 $H_0$ 不成立，可以认为 $X$ 与 $Y$ 独立。**

这种利用 $\chi^2$ 的取值推断分类变量 $X$ 和 $Y$ 是否成立的方法称作 $\chi^2$ 独立性检验。

常用的小概率值 $a$ 与对应的临界值如下：

|$a$|0.1|0.05|0.01|0.005|0.001|
|:----:|:----:|:----:|:----:|:----:|:----:|
|$x_a$|2.706|3.841|6.635|7.879|10.828|